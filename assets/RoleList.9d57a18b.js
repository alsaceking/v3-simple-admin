import{r as T}from"./mock.52d431bf.js";import{d as U}from"./util.d7d89ab6.js";import{_ as N,r as g,q as j,a as n,b as L,c as M,e,w as s,d as x,t as F,u as p,y as K,p as O,f as P,k,z as q,o as G,E as $}from"./index.d3f51e53.js";const H=C=>(O("data-v-8f8d57f0"),C=C(),P(),C),J={class:"wrapper"},Q={class:"tree-wrapper"},X=H(()=>x("h2",{class:"title"},"\u83DC\u5355\u5206\u914D",-1)),Y={class:"drawer-footer"},Z=k("\u53D6\u6D88"),ee=k("\u786E\u8BA4"),te={emits:["saveAdd","saveEdit"],setup(C,{expose:_,emit:i}){const m=g(!1),w=g(!1),t=j({roleName:"",status:!0,remarks:"",permissionMenuId:[],menuList:[]}),b=g(null),I={children:"subs",label:"title"},V=()=>{m.value=!1},o=()=>{q.confirm("\u662F\u5426\u786E\u8BA4\u63D0\u4EA4\u4FDD\u5B58!","\u63D0\u793A",{type:"warning"}).then(()=>{w.value?d():c()}).catch(()=>{})},d=()=>{i("saveAdd",t)},c=()=>{i("saveEdit",t)},f=()=>{const a=b.value.getCheckedKeys(!0),l=b.value.getCheckedNodes(!1,!0);t.permissionMenuId=a,t.menuList=E(l)},y=a=>{b.value.setCheckedKeys(a)},E=a=>{let l=[];return a.forEach(u=>{u.parentId||(u.subs=[],l.push(u));for(let r=0;r<a.length;r++)a[r].parentId&&a[r].parentId===u.id&&(a[r].subs&&(a[r].subs=[]),u.subs.push(a[r]))}),l};return _({hideDrawer:()=>{m.value=!1},showDrawer:()=>{m.value=!0},allowIsAdd:()=>{w.value=!0},notAdd:()=>{w.value=!1},resetRoleForm:()=>{t.roleName="",t.status=!0,t.remarks="",setTimeout(()=>{y([])})},setRoleForm:a=>{Object.keys(t).forEach(l=>{t[l]=a[l]}),setTimeout(()=>{y(a.permissionMenuId)})}}),(a,l)=>{const u=n("el-input"),r=n("el-form-item"),S=n("el-switch"),W=n("el-form"),z=n("el-tree"),R=n("el-button"),B=n("el-drawer");return L(),M("div",J,[e(B,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=v=>m.value=v),size:"50%"},{title:s(()=>[x("h4",null,F(w.value?"\u6DFB\u52A0\u89D2\u8272":"\u7F16\u8F91\u89D2\u8272"),1)]),default:s(()=>[e(W,{model:p(t),"label-width":"70px"},{default:s(()=>[e(r,{label:"\u89D2\u8272\u540D"},{default:s(()=>[e(u,{modelValue:p(t).roleName,"onUpdate:modelValue":l[0]||(l[0]=v=>p(t).roleName=v),autocomplete:"off",placeholder:"\u89D2\u8272\u540D"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u72B6\u6001"},{default:s(()=>[e(S,{modelValue:p(t).status,"onUpdate:modelValue":l[1]||(l[1]=v=>p(t).status=v),width:60,"inline-prompt":"","active-text":"\u542F\u7528","inactive-text":"\u7981\u7528"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u5907\u6CE8"},{default:s(()=>[e(u,{modelValue:p(t).remarks,"onUpdate:modelValue":l[2]||(l[2]=v=>p(t).remarks=v),type:"textarea",placeholder:"\u5907\u6CE8",maxlength:"35","show-word-limit":"",resize:"none"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),x("div",Q,[X,e(z,{ref_key:"treeRef",ref:b,data:p(K),"show-checkbox":"","node-key":"id","highlight-current":"","default-expand-all":!0,props:I,onCheckChange:f},null,8,["data"])])]),footer:s(()=>[x("div",Y,[e(R,{onClick:V},{default:s(()=>[Z]),_:1}),e(R,{type:"primary",onClick:o},{default:s(()=>[ee]),_:1})])]),_:1},8,["modelValue"])])}}};var oe=N(te,[["__scopeId","data-v-8f8d57f0"]]);const se={class:"wrapper"},le={class:"add-btn"},ae=k("\u6DFB\u52A0\u89D2\u8272"),ne=k("\u7F16\u8F91"),re=k("\u5220\u9664 "),de={setup(C){G(()=>{_.value=T});const _=g([]),i=g(null),m=o=>{_.value.splice(o,1),$.success("\u5220\u9664\u6210\u529F!")},w=()=>{const o=i.value;o.resetRoleForm(),o.allowIsAdd(),o.showDrawer()};let t=-1;const b=(o,d)=>{t=o;const c=i.value;c.notAdd(),c.setRoleForm(d),c.showDrawer()},I=o=>{const d=U(o);_.value.push(d),i.value.hideDrawer(),$.success("\u6DFB\u52A0\u6210\u529F")},V=o=>{Object.keys(o).forEach(d=>{_.value[t][d]=o[d]}),i.value.hideDrawer(),$.success(`\u4FEE\u6539\u7B2C ${t+1} \u884C\u6210\u529F`)};return(o,d)=>{const c=n("el-button"),f=n("el-table-column"),y=n("el-tag"),E=n("el-popconfirm"),A=n("el-table");return L(),M("div",se,[x("div",le,[e(c,{icon:o.$Icons.Plus,type:"primary",onClick:w},{default:s(()=>[ae]),_:1},8,["icon"])]),e(A,{data:_.value,border:"",stripe:""},{default:s(()=>[e(f,{prop:"roleName",label:"\u89D2\u8272\u540D\u79F0"}),e(f,{prop:"status",label:"\u72B6\u6001"},{default:s(h=>[e(y,{type:h.row.status?"":"danger"},{default:s(()=>[k(F(h.row.status?"\u542F\u7528":"\u7981\u7528"),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"remarks",label:"\u5907\u6CE8"}),e(f,{prop:"date",label:"\u521B\u5EFA\u65F6\u95F4",width:"120"}),e(f,{fixed:"right",label:"\u64CD\u4F5C",width:"180"},{default:s(h=>[e(c,{class:"opt-btn",icon:o.$Icons.Edit,type:"primary",size:"small",onClick:D=>b(h.$index,h.row)},{default:s(()=>[ne]),_:2},1032,["icon","onClick"]),e(E,{"confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88","icon-color":"red",title:"\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:D=>m(h.$index)},{reference:s(()=>[e(c,{class:"opt-btn",icon:o.$Icons.Delete,type:"danger",size:"small"},{default:s(()=>[re]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(oe,{ref_key:"editWrapper",ref:i,onSaveAdd:I,onSaveEdit:V},null,512)])}}};var fe=N(de,[["__scopeId","data-v-19c45abf"]]);export{fe as default};
